# PINN Temperature Sensor Analysis

##  Project Overview

Physics-Informed Neural Network (PINN) for analyzing temperature sensor data from 9 sensors positioned in a 3x3 grid. This project implements a neural network with physics constraints to predict temperature distributions and solve the heat equation.

![System Visualization](results/plots/system_animation.gif)
*Fire simulation setup showing couch fire, vent configuration, and temperature sensor locations*

## Features

- **Physics-Informed Neural Network**: Incorporates heat equation constraints
- **Adaptive Weighting**: Dynamic sensor weighting for balanced training
- **Time-dependent Parameters**: Variable thermal diffusivity based on time
- **Comprehensive Visualization**: Multiple plots for analysis and validation
- **Modular Architecture**: Clean, organized code structure

## Project Structure

```
├── main.py                     # Main execution script
├── requirements.txt            # Python dependencies
├── README.md                   # This file
├── data/                       # Data files
│   ├── devc.csv
│   ├── devpos.json
│   ├── dfdevc.csv
│   ├── dfdevc_norm.csv
│   └── couch.fds               # FDS input file
├── src/                        # Source code modules
│   ├── __init__.py
│   ├── pinn_model.py          # PINN model implementation
│   ├── data_processing.py     # Data loading and preprocessing
│   ├── training.py            # Training functions
│   └── visualization.py       # Plotting and visualization
├── notebooks/                  # Jupyter notebooks
│   ├── analysis.ipynb
│   ├── tuning1.ipynb
│   ├── tuning2.ipynb
│   ├── ad.ipynb
│   └── gpt.ipynb

```






## Final Tuned Hyperparameters

The model uses the following optimized hyperparameters from extensive tuning:

```python
config = {
    'lr': 0.001,
    'layers': [3, 128, 128, 128, 1],
    'activation': "tanh",
    'epochs': 500,
    'w_data': 0.9,      # Data loss weight
    'w_pde': 1e-3,      # PDE loss weight
    'pde_weight_min': 1e-6,
    'pde_weight_max': 0.05,
    'pde_ramp_power': 2.0
}
```

##  Results

The model achieves:
- **RMSE**: 11.7


##  Methodology

### Data Collection from FDS/PyroSim

The temperature data was collected from a fire dynamics simulation using FDS (Fire Dynamics Simulator) and PyroSim software:

**Simulation Setup:**
- **Room Dimensions**: 3 m × 3 m × 2.5 m
- **Couch Fire**: Single couch test case with polyurethane foam and fabric materials
- **Vent Configuration**: 3 m × 2 m vent placed opposite to the couch for smoke and heat exit
- **Simulation Duration**: 600 seconds (10 minutes)
- **Mesh Resolution**: 25×25×24 cells per mesh block with 4 mesh blocks total

![Fire Simulation Setup](![Fire Simulation Setup](https://github.com/AD4ourty7even/FireVentPINN/raw/master/pyrosimgif.gif))
*Visualization of the FDS simulation showing fire development, smoke propagation, and sensor locations*

**Sensor Configuration:**
- **9 Temperature Sensors (TC1-TC9)** positioned in a 3×3 grid at the vent region
- **Sensor Locations**: 
  - Row 1: (1.0,0.0), (2.5,0.0), (4.0,0.0) at heights 0.0m, 1.0m, 2.0m
  - Row 2: (1.0,1.0), (2.5,1.0), (4.0,1.0) at heights 0.0m, 1.0m, 2.0m  
  - Row 3: (1.0,2.0), (2.5,2.0), (4.0,2.0) at heights 0.0m, 1.0m, 2.0m
- **Data Collection**: Temporal evolution of temperature (T vs t) for each sensor
- **Sampling Rate**: 5-second intervals (DT_DEVC=5.0)

**Material Properties:**
- **Couch Materials**: Fabric (density: 50 kg/m³) and Foam (density: 40 kg/m³)
- **Heat of Combustion**: 2.27×10⁴ kJ/kg for polyurethane
- **Ignition**: 1000°C ignitor particle at couch center
- **Room Walls**: Gypsum plaster with 0.5 W/m·K conductivity

**Computational Constraints:**
- Focused only on vent region due to computational limitations
- Other physical variables (velocity, pressure, species concentration, radiation) were not recorded to simplify computation
- Temperature data was the primary focus for PINN training

### Physics-Informed Neural Network
- **Input**: Spatial coordinates (x, z) and time (t)
- **Output**: Temperature prediction
- **Physics Constraint**: Heat equation with time-dependent diffusivity

### Heat Equation
```
∂T/∂t = α(t) * (∂²T/∂x² + ∂²T/∂z²)
```

Where:
- `α(t) = 2e-5` for t ≤ 15s
- `α(t) = 1.9e-5` for t > 15s

### Training Strategy
1. **Data Loss**: MSE between predicted and actual temperatures
2. **Physics Loss**: PDE residual minimization
3. **Adaptive Weighting**: Dynamic sensor weighting based on prediction errors
4. **Gradient Clipping**: Prevents exploding gradients



##  Data Source

**FDS Input File**: `couch.fds`
- Generated by PyroSim 2025.1.0826
- Simulation title: "Single Couch Test Case"
- Total simulation time: 600 seconds
- Output frequency: 5-second intervals

**Key Simulation Parameters:**
- Mesh blocks: 4 blocks of 25×25×24 cells each
- Domain: 5.0m × 5.0m × 2.4m total
- Ignition: 1000°C ignitor particle
- Materials: Polyurethane foam, fabric upholstery, gypsum plaster walls
- Vent: 3m × 2m opening for smoke and heat exit

##  Research Context

This project demonstrates the application of Physics-Informed Neural Networks to solve partial differential equations in fire safety engineering. The methodology combines:

- **Fire dynamics simulation** using FDS/PyroSim for realistic data generation
- **Data-driven learning** from temperature sensor measurements
- **Physics constraints** from the heat equation
- **Adaptive optimization** for improved convergence in complex fire scenarios





